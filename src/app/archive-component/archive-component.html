<!-- archive.component.html -->
<div class="archive-page">
  <!-- Header -->
  <div class="archive-header">
    <button class="back-btn" (click)="goBack()">
      â† Torna al Generatore
    </button>
    <h1>ğŸ“ Archivio Contenuti</h1>
    <div class="header-stats">
      <span class="stat">
        {{ filteredPosts.length }} di {{ savedPosts.length }} contenuti
      </span>
    </div>
  </div>

  <!-- Filtri e Ricerca -->
  <div class="archive-controls">
    <div class="search-box">
      <input type="text" 
             [(ngModel)]="searchTerm" 
             (input)="onSearchChange()"
             placeholder="ğŸ” Cerca nei contenuti o per brand...">
    </div>
    
    <div class="category-filters">
      <div *ngFor="let category of categories" 
           class="category-filter"
           [class.active]="selectedCategory === category.id"
           [style.border-color]="category.color"
           (click)="onCategoryChange(category.id)">
        <span class="category-icon" [style.color]="category.color">
          {{ category.icon }}
        </span>
        <span class="category-name">{{ category.name }}</span>
        <span class="category-count">
          {{ getCategoryCount(category.id) }}
        </span>
      </div>
    </div>
  </div>

  <!-- Contenuto -->
  <div class="archive-content">
    <div *ngIf="isLoading" class="loading-state">
      <div class="spinner"></div>
      <p>Caricamento contenuti...</p>
    </div>

    <div *ngIf="!isLoading && filteredPosts.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ“­</div>
      <h3>Nessun contenuto trovato</h3>
      <p *ngIf="selectedCategory !== 'all' || searchTerm">
        Prova a cambiare filtro o termine di ricerca
      </p>
      <p *ngIf="selectedCategory === 'all' && !searchTerm">
        Non hai ancora salvato nessun contenuto. Torna al generatore per crearne!
      </p>
    </div>

    <!-- Grid dei contenuti -->
    <div *ngIf="!isLoading && filteredPosts.length > 0" class="content-section">
      <div class="results-info">
        <span>Mostrando {{ paginatedPosts.length }} di {{ filteredPosts.length }} risultati</span>
      </div>

      <div class="posts-grid">
        <div *ngFor="let post of paginatedPosts" class="post-card">
          <div class="post-header">
            <div class="post-type-badge" [style.background]="getCategoryColor(post.tipo)">
              {{ getCategoryIcon(post.tipo) }}
              <span>{{ getCategoryName(post.tipo) }}</span>
            </div>
            <div class="post-actions">
              <button class="btn-copy" 
                      (click)="copyToClipboard(post.contenuto)"
                      title="Copia negli appunti">
                ğŸ“‹
              </button>
              <button class="btn-delete" 
                      (click)="deletePost(post.id)"
                      title="Elimina contenuto">
                ğŸ—‘ï¸
              </button>
            </div>
          </div>

          <div class="post-content">
            {{ post.contenuto }}
          </div>

          <div class="post-footer">
            <div class="post-meta">
              <span class="post-platform">
                {{ getPlatformIcon(post.piattaforma) }} {{ post.piattaforma }}
              </span>
              <span class="post-date">
                {{ post.dataSalvataggio | date:'dd/MM/yy HH:mm' }}
              </span>
            </div>
            <div *ngIf="post.brandName" class="post-brand">
              <strong>Brand:</strong> {{ post.brandName }}
            </div>
          </div>
        </div>
      </div>

      <!-- Paginazione -->
      <div *ngIf="totalPages > 1" class="pagination">
        <button class="pagination-btn" 
                [disabled]="currentPage === 1"
                (click)="prevPage()">
          â€¹ Precedente
        </button>
        
        <div class="page-numbers">
          <button *ngFor="let page of getPageNumbers()" 
                  class="page-btn"
                  [class.active]="page === currentPage"
                  (click)="goToPage(page)">
            {{ page }}
          </button>
        </div>
        
        <button class="pagination-btn" 
                [disabled]="currentPage === totalPages"
                (click)="nextPage()">
          Successiva â€º
        </button>
      </div>
    </div>
  </div>
</div>